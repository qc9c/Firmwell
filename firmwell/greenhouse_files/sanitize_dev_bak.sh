#!/greenhouse/bash
DIR="/dev"
DATA="8467206204610564372101238468369273619216273019100147216372162374184672062046105643721012384683692736192162730191001472163721623742846720620461056437210123846836927361921627301910014721637216237438467206204610564372101238468369273619216273019100147216372162374484672062046105643721012384683692736192162730191001472163721623745846720620461056437210123846836927361921627301910014721637216237468467206204610564372101238468369273619216273019100147216372162374784672062046105643721012384683692736192162730191001472163721623748846720620461056437210123846836927361921627301910014721637216237498467206204610564372101238468369273619216273019100147216372162374108467206204610564372101238468369273619216273019100147216372162374118467206204610564372101238468369273619216273019100147216372162374128467206204610564372101238468369273619216273019100147216372162374138467206204610564372101238468369273619216273019100147216372162374148467206204610564372101238468369273619216273019100147216372162374158467206204610564372101238468369273619216273019100147216372162374168467206204610564372101238468369273619216273019100147216372162374178467206204610564372101238468369273619216273019100147216372162374188467206204610564372101238468369273619216273019100147216372162374198467206204610564372101238468369273619216273019100147216372162374208467206204610564372101238468369273619216273019100147216372162374218467206204610564372101238468369273619216273019100147216372162374228467206204610564372101238468369273619216273019100147216372162374238467206204610564372101238468369273619216273019100147216372162374248467206204610564372101238468369273619216273019100147216372162374258467206204610564372101238468369273619216273019100147216372162374268467206204610564372101238468369273619216273019100147216372162374278467206204610564372101238468369273619216273019100147216372162374288467206204610564372101238468369273619216273019100147216372162374298467206204610564372101238468369273619216273019100147216372162374308467206204610564372101238468369273619216273019100147216372162374318467206204610564372101238468369273619216273019100147216372162374328467206204610564372101238468369273619216273019100147216372162374338467206204610564372101238468369273619216273019100147216372162374348467206204610564372101238468369273619216273019100147216372162374358467206204610564372101238468369273619216273019100147216372162374368467206204610564372101238468369273619216273019100147216372162374378467206204610564372101238468369273619216273019100147216372162374388467206204610564372101238468369273619216273019100147216372162374398467206204610564372101238468369273619216273019100147216372162374408467206204610564372101238468369273619216273019100147216372162374418467206204610564372101238468369273619216273019100147216372162374428467206204610564372101238468369273619216273019100147216372162374438467206204610564372101238468369273619216273019100147216372162374448467206204610564372101238468369273619216273019100147216372162374458467206204610564372101238468369273619216273019100147216372162374468467206204610564372101238468369273619216273019100147216372162374478467206204610564372101238468369273619216273019100147216372162374488467206204610564372101238468369273619216273019100147216372162374498467206204610564372101238468369273619216273019100147216372162374508467206204610564372101238468369273619216273019100147216372162374518467206204610564372101238468369273619216273019100147216372162374528467206204610564372101238468369273619216273019100147216372162374538467206204610564372101238468369273619216273019100147216372162374548467206204610564372101238468369273619216273019100147216372162374558467206204610564372101238468369273619216273019100147216372162374568467206204610564372101238468369273619216273019100147216372162374578467206204610564372101238468369273619216273019100147216372162374588467206204610564372101238468369273619216273019100147216372162374598467206204610564372101238468369273619216273019100147216372162374608467206204610564372101238468369273619216273019100147216372162374618467206204610564372101238468369273619216273019100147216372162374628467206204610564372101238468369273619216273019100147216372162374638467206204610564372101238468369273619216273019100147216372162374648467206204610564372101238468369273619216273019100147216372162374658467206204610564372101238468369273619216273019100147216372162374668467206204610564372101238468369273619216273019100147216372162374678467206204610564372101238468369273619216273019100147216372162374688467206204610564372101238468369273619216273019100147216372162374698467206204610564372101238468369273619216273019100147216372162374708467206204610564372101238468369273619216273019100147216372162374718467206204610564372101238468369273619216273019100147216372162374728467206204610564372101238468369273619216273019100147216372162374738467206204610564372101238468369273619216273019100147216372162374748467206204610564372101238468369273619216273019100147216372162374758467206204610564372101238468369273619216273019100147216372162374768467206204610564372101238468369273619216273019100147216372162374778467206204610564372101238468369273619216273019100147216372162374788467206204610564372101238468369273619216273019100147216372162374798467206204610564372101238468369273619216273019100147216372162374808467206204610564372101238468369273619216273019100147216372162374818467206204610564372101238468369273619216273019100147216372162374828467206204610564372101238468369273619216273019100147216372162374838467206204610564372101238468369273619216273019100147216372162374848467206204610564372101238468369273619216273019100147216372162374858467206204610564372101238468369273619216273019100147216372162374868467206204610564372101238468369273619216273019100147216372162374878467206204610564372101238468369273619216273019100147216372162374888467206204610564372101238468369273619216273019100147216372162374898467206204610564372101238468369273619216273019100147216372162374908467206204610564372101238468369273619216273019100147216372162374918467206204610564372101238468369273619216273019100147216372162374928467206204610564372101238468369273619216273019100147216372162374938467206204610564372101238468369273619216273019100147216372162374948467206204610564372101238468369273619216273019100147216372162374958467206204610564372101238468369273619216273019100147216372162374968467206204610564372101238468369273619216273019100147216372162374978467206204610564372101238468369273619216273019100147216372162374988467206204610564372101238468369273619216273019100147216372162374998467206204610564372101238468369273619216273019100147216372162374100"

check_and_create_file() {
    local file_name=$1
    if [ ! -f "$DIR/$file_name" ]; then
        touch "$DIR/$file_name"
        chmod 777 "$DIR/$file_name"
    fi
}

#check_and_write_if_empty() {
#    local file_name=$1
#    local data="8467206204610564372101238468369273619216273019100147216372162374"
#    if [ -f "$DIR/$file_name" ] && [ ! -s "$DIR/$file_name" ]; then
##        echo $(printf '%s%.0s' "$data" {1..100}) > "$DIR/$file_name"
#        echo $(printf '%s' "$data"{1..100}) > "$DIR/$file_name"
#    fi
#}

check_and_write_if_empty() {
    local file_name=$1
    if [ ! -f "$DIR/$file_name" ]; then
        touch "$DIR/$file_name"
    fi
    if [ -f "$DIR/$file_name" ]; then
        local size=$(-c <"$DIR/$file_name")
        if [ $size -lt 64 ]; then
            echo "$DATA" >> "$DIR/$file_name"
        fi
    fi
}

#protected_files=("random" "urandom")

while true; do
#  for file in "$DIR"/*; do
#      if [ "$filename" = "random" ] || [ "$filename" = "urandom" ]; then
#          continue
#      fi
#      if [ -c "$file" ] || [ -b "$file" ]; then
#          rm "$file"
#          filename=$(basename -- "$file")
#          touch "$DIR/$filename"
#          chmod 777 "$DIR/$filename"
#      fi
#  done

  find "$DIR" -type f | while read file; do
    filename=$(basename -- "$file")

    if [ "$filename" = "random" ] || [ "$filename" = "urandom" ]; then
        continue
    fi

    if [ -c "$file" ] || [ -b "$file" ]; then
        rm "$file"
        touch "$DIR/$filename"
        chmod 777 "$DIR/$filename"
    fi
  done

  check_and_create_file "console"
  check_and_create_file "acos_nat_cli"
  check_and_create_file "null"

  check_and_write_if_empty "random"
  check_and_write_if_empty "urandom"

  sleep 1

done